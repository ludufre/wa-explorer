<ion-content class="pickup-content">
  <div class="pickup-container">
    <div class="pickup-header">
      <ion-button
        (click)="backToHome()"
        fill="clear"
        size="small"
        class="back-button"
      >
        <fa-icon icon="chevron-left"></fa-icon>
        {{ 'PAGES.PICKUP.BACK_TO_HOME' | translate }}
      </ion-button>
      <h1>{{ 'PAGES.PICKUP.TITLE' | translate }}</h1>
      <ion-button (click)="ngOnInit()" fill="clear" size="small">
        <fa-icon icon="sync"></fa-icon>
      </ion-button>
    </div>

    @if (loaded) {
      @if (options.length > 0) {
        <ion-list class="round" lines="full">
          <div class="list-header">
            {{ 'PAGES.PICKUP.ITUNES_BACKUP' | translate }}
          </div>
          @for (opt of options; track opt) {
            <ion-item button (click)="select(opt)" [detail]="!!!opt.error">
              <ion-label>
                @if (!!!opt.error) {
                  <h1>
                    {{ opt.name }}
                    @if (!!!opt?.chatStorage) {
                      <span>
                        ({{ 'PAGES.PICKUP.INVALID_MISSING' | translate }})
                      </span>
                    }
                  </h1>
                } @else {
                  <h1>
                    <span style="color: red">
                      {{ 'PAGES.PICKUP.FAIL' | translate }}
                    </span>
                  </h1>
                }
                @if (!!!opt.error) {
                  <h2>
                    {{ opt.device }} / {{ opt.version }} / {{ opt.serial }}
                  </h2>
                  <h3>{{ opt.date | dfnsFormat: 'dd/MM/yyyy HH:mm' }}h</h3>
                }
                <p>{{ opt.path }}</p>
                @if (!!opt.error) {
                  <p>{{ opt.error | translate }}</p>
                }
              </ion-label>
            </ion-item>
          }
        </ion-list>

        <div class="ion-text-center">
          <p>{{ 'PAGES.PICKUP.OR' | translate }}</p>
        </div>
      }

      @if (options.length === 0) {
        <h2 color="primary">{{ 'PAGES.PICKUP.EMPTY' | translate }}</h2>
      }

      <div class="ion-text-center">
        <ion-button (click)="dialog()" class="ion-text-center">
          {{ 'PAGES.PICKUP.PICK_FOLDER' | translate }}
        </ion-button>
      </div>
    }

    @if (!loaded) {
      <h2 color="primary">
        {{ 'PAGES.PICKUP.LOADING' | translate }}
      </h2>
    }
  </div>
</ion-content>
