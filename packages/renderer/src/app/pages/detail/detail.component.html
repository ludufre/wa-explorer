<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/pickup"></ion-back-button>
    </ion-buttons>
    <ion-title>{{ contactName || contactJid }}</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <div class="messages-container">
    @if (loading) {
      <div class="loading-container">
        <ion-spinner></ion-spinner>
        <p>{{ 'PAGES.DETAIL.LOADING' | translate }}</p>
      </div>
    }

    @if (error) {
      <div class="error-container">
        <p>{{ error | translate }}</p>
        <a routerLink="/pickup">{{ 'PAGES.DETAIL.BACK_TO_HOME' | translate }}</a>
      </div>
    }

    @if (!loading && !error && messages.length === 0) {
      <div class="empty-container">
        <p>{{ 'PAGES.DETAIL.NO_MESSAGES' | translate }}</p>
      </div>
    }

    @if (!loading && !error && messages.length > 0) {
      <div class="messages-list">
        @for (message of messages; track message.id) {
          <div class="message" [class.from-me]="message.isFromMe" [class.from-them]="!message.isFromMe">
            <div class="message-bubble">
              @if (!message.isFromMe && message.groupMember) {
                <div class="message-sender">{{ message.groupMember }}</div>
              }
              <div class="message-text">{{ message.text || '(media)' }}</div>
              <div class="message-time">{{ formatTime(message.date) }}</div>
            </div>
          </div>
        }
      </div>
    }
  </div>
</ion-content>
