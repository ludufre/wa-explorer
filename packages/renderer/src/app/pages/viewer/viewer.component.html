@if (!hasBackupSelected) {
  <!-- Mostra PickupPage full-width quando nenhum backup selecionado -->
  <app-pickup></app-pickup>
} @else {
  <!-- Layout 2 colunas quando backup selecionado -->
  <div class="viewer-layout">
    <!-- Coluna 1: Chat List (320px) -->
    <div class="chat-list-column">
      <div class="chat-list-header">
        <ion-button
          fill="clear"
          size="small"
          (click)="handleBackToPickup()"
          class="back-button"
        >
          <fa-icon icon="chevron-left"></fa-icon>
          {{ 'PAGES.VIEWER.BACK_TO_SELECTION' | translate }}
        </ion-button>
      </div>

      <div class="search-container">
        <ion-searchbar
          [value]="searchQuery()"
          (ionInput)="handleSearch($event)"
          [placeholder]="'PAGES.VIEWER.SEARCH_PLACEHOLDER' | translate"
          class="chat-searchbar"
        ></ion-searchbar>
      </div>

      <ion-content class="list-content">
        <cdk-virtual-scroll-viewport
          appendOnly
          itemSize="50"
          class="scroll-viewport"
        >
          <ion-list class="chat-list">
            <!-- @for (s of filteredSessions(); track s.id) { -->
            <ng-container *cdkVirtualFor="let s of filteredSessions()">
              <ion-item
                button
                [routerLink]="['detail', s.contact]"
                routerLinkActive="selected"
                class="chat-item"
                lines="none"
              >
                <ion-avatar slot="start">
                  <img
                    [src]="
                      s.picture ||
                      'https://ui-avatars.com/api/?background=438ECF&color=fff&name=' +
                        s.name +
                        '&length=2'
                    "
                    [alt]="s.name"
                  />
                </ion-avatar>
                <ion-label>
                  <h2>{{ s.name }}</h2>
                  <p>{{ s.last | date: 'short' }}</p>
                </ion-label>
              </ion-item>
            </ng-container>
            <!-- } -->
          </ion-list>
        </cdk-virtual-scroll-viewport>
      </ion-content>
    </div>

    <!-- Coluna 2: Detail View (flex) -->
    <div class="detail-column">
      <ion-router-outlet></ion-router-outlet>
    </div>
  </div>
}
